<?xml version="1.0" encoding="UTF-8"?>
<!-- 
 * SqlMap-W8001ProgCtrl.xml
 *
 * W8001ProgCtrlDaoのSqlMapファイルです。
 *
 * Copyright (c) 2014 DENSO CORPORATION. All rights reserved.
-->
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
 
<sqlMap namespace="W8001ProgCtrl">
    <!-- ================================================== -->
    <!-- Domainの別名定義 -->
    <!-- ================================================== -->
    <!-- Domain -->
    <typeAlias alias="W8001ProgCtrlDomain"
        type="com.globaldenso.eca0027.core.business.domain.W8001ProgCtrlDomain" />
    <typeAlias alias="W8001ProgCtrlPltzItemDomain"
        type="com.globaldenso.eca0027.core.business.domain.W8001ProgCtrlPltzItemDomain" />
    <typeAlias alias="W8001ProgCtrlPltzItemOdrDomain"
        type="com.globaldenso.eca0027.core.business.domain.W8001ProgCtrlPltzItemOdrDomain" />

    <!-- CriteriaDomain -->
    <typeAlias alias="W8001ProgCtrlCriteriaDomain"
        type="com.globaldenso.eca0027.core.business.domain.criteria.W8001ProgCtrlCriteriaDomain" />
         
    <!-- ================================================== -->
    <!-- 検索結果をMapで受け取る                            -->
    <!-- ================================================== -->
    <!-- W8001ProgCtrlDomain_SearchForPagingTtPltzByItemNo -->
    <resultMap id="W8001ProgCtrlDomain_SearchForPagingTtPltzByItemNo" class="W8001ProgCtrlDomain">
        <result property="mainMark" column="MAIN_MARK" />
        <result property="shipperCd" column="SHIPPER_CD" />
        <result property="invoiceNo" column="INVOICE_NO" />
        <result property="containerLooseTyp" column="CONTAINER_LOOSE_TYP" />
        <result property="trnsCd" column="TRNS_CD" />
        <result property="shipToCd" column="SHIP_TO_CD" />
        <result property="consigneeCd" column="CONSIGNEE_CD" />
        <result property="curWhCompCd" column="CUR_WH_COMP_CD" />
        <result property="invoiceCtgry" column="INVOICE_CTGRY" />
        <result property="curWhCd" column="CUR_WH_CD" />
        <result property="cmlTyp" column="CML_TYP" />
        <result property="invoiceKey" column="INVOICE_KEY" />
        <result property="customTimingTyp" column="CUSTOM_TIMING_TYP" />
        <result property="lastTrStatus" column="LAST_TR_STATUS" />
        <result property="etd" column="ETD" />
        <result property="atd" column="ATD" />
        <result property="eta" column="ETA" />
        <result property="registerDt" column="REGISTER_DT" />
        <result property="stgActDt" column="STG_ACT_DT" />
        <result property="shippingFirmDt" column="SHIPPING_FIRM_DT" />
        <result property="stgInstrDt" column="STG_INSTR_DT" />
        <result property="timezoneId" column="TIMEZONE_ID" />
        <result property="pltzItemList" resultMap="W8001ProgCtrl.W8001ProgCtrlPltzItemDomain_SearchForPagingTtPltzByItemNo" />
    </resultMap>
    <resultMap id="W8001ProgCtrlPltzItemDomain_SearchForPagingTtPltzByItemNo" class="W8001ProgCtrlPltzItemDomain">
        <result property="sumQty" column="SUM_QTY" />
    </resultMap>
    

    <!-- W8001ProgCtrlDomain_SearchForPagingTtPltzByPoNo -->
    <resultMap id="W8001ProgCtrlDomain_SearchForPagingTtPltzByPoNo" class="W8001ProgCtrlDomain">
        <result property="mainMark" column="MAIN_MARK" />
        <result property="shipperCd" column="SHIPPER_CD" />
        <result property="invoiceNo" column="INVOICE_NO" />
        <result property="invoiceCtgry" column="INVOICE_CTGRY" />
        <result property="trnsCd" column="TRNS_CD" />
        <result property="shipToCd" column="SHIP_TO_CD" />
        <result property="consigneeCd" column="CONSIGNEE_CD" />
        <result property="curWhCompCd" column="CUR_WH_COMP_CD" />
        <result property="curWhCd" column="CUR_WH_CD" />
        <result property="cmlTyp" column="CML_TYP" />
        <result property="invoiceKey" column="INVOICE_KEY" />
        <result property="customTimingTyp" column="CUSTOM_TIMING_TYP" />
        <result property="lastTrStatus" column="LAST_TR_STATUS" />
        <result property="etd" column="ETD" />
        <result property="atd" column="ATD" />
        <result property="eta" column="ETA" />
        <result property="registerDt" column="REGISTER_DT" />
        <result property="stgActDt" column="STG_ACT_DT" />
        <result property="shippingFirmDt" column="SHIPPING_FIRM_DT" />
        <result property="stgInstrDt" column="STG_INSTR_DT" />
        <result property="timezoneId" column="TIMEZONE_ID" />
    </resultMap>

    <!-- W8001ProgCtrlDomain_SearchTtPltz -->
    <resultMap id="W8001ProgCtrlDomain_SearchTtPltz" class="W8001ProgCtrlDomain">
        <result property="trnsCd" column="TRNS_CD" />
        <result property="cmlTyp" column="CML_TYP" />
        <result property="consigneeCd" column="CONSIGNEE_CD" />
        <result property="shipToCd" column="SHIP_TO_CD" />
        <result property="customerCd" column="CUSTOMER_CD" />
        <result property="lgcyShipTo" column="LGCY_SHIP_TO" />
        <result property="stgInstrItemFlg" column="STG_INSTR_ITEM_FLG" />
        <result property="volume" column="VOLUME" />
        <result property="netWeight" column="NET_WEIGHT" />
        <result property="grossWeight" column="GROSS_WEIGHT" />
        <result property="containerSortingKey" column="CONTAINER_SORTING_KEY" />
        <result property="loadingCd" column="LOADING_CD" />
        <result property="containerLooseTyp" column="CONTAINER_LOOSE_TYP" />
        <result property="returnStyleCd" column="RETURN_STYLE_CD" />
        <result property="stgInstrNo" column="STG_INSTR_NO" />
        <result property="xmainMark" column="XMAIN_MARK" />
        <result property="stgActNo" column="STG_ACT_NO" />
        <result property="shippingFirmNo" column="SHIPPING_FIRM_NO" />
        <result property="shipperCd" column="SHIPPER_CD" />
        <result property="invoiceNo" column="INVOICE_NO" />
        <result property="expRequestNo" column="EXP_REQUEST_NO" />
        <result property="invoiceCtgry" column="INVOICE_CTGRY" />
        <result property="priceTerms" column="PRICE_TERMS" />
        <result property="tradeTerms" column="TRADE_TERMS" />
        <result property="currCd" column="CURR_CD" />
        <result property="lcNo" column="LC_NO" />
        <result property="freight" column="FREIGHT" />
        <result property="freightResponsibleCd" column="FREIGHT_RESPONSIBLE_CD" />
        <result property="insurance" column="INSURANCE" />
        <result property="netAmount" column="NET_AMOUNT" />
        <result property="totalInvoiceAmount" column="TOTAL_INVOICE_AMOUNT" />
        <result property="loadingPortCd" column="LOADING_PORT_CD" />
        <result property="dischargePortCd" column="DISCHARGE_PORT_CD" />
        <result property="payMeth" column="PAY_METH" />
        <result property="payTerms" column="PAY_TERMS" />
        <result property="totalVolume" column="TOTAL_VOLUME" />
        <result property="totalNetWeight" column="TOTAL_NET_WEIGHT" />
        <result property="totalGrossWeight" column="TOTAL_GROSS_WEIGHT" />
        <result property="totalWeightUnit" column="TOTAL_WEIGHT_UNIT" />
        <result property="totalVolumeUnit" column="TOTAL_VOLUME_UNIT" />
        <result property="billdNo" column="BILLD_NO" />
        <result property="atd" column="ATD" />
        <result property="eta" column="ETA" />
        <result property="carrierCompCd" column="CARRIER_COMP_CD" />
        <result property="vessel" column="VESSEL" />
        <result property="compNmAbb1" column="COMP_NM_ABB1" />
        <result property="shipToNmAbb1" column="SHIP_TO_NM_ABB1" />
        <result property="compNmAbb2" column="COMP_NM_ABB2" />
        <result property="shipToNmAbb2" column="SHIP_TO_NM_ABB2" />
        <result property="weightUnitDisp" column="WEIGHT_UNIT_DISP" />
        <result property="volumeUnitDisp" column="VOLUME_UNIT_DISP" />
        <result property="containerNo" column="CONTAINER_NO" />
    </resultMap>

    <!-- W8001ProgCtrlDomain_SearchForPagingTtPltzItemByCigma -->
    <resultMap id="W8001ProgCtrlDomain_SearchForPagingTtPltzItemByCigma" class="W8001ProgCtrlDomain">
        <result property="auth" column="AUTH" />
        <result property="pltzItemList" resultMap="W8001ProgCtrl.W8001ProgCtrlPltzItemDomain_SearchForPagingTtPltzItemByCigma" />
    </resultMap>
    <resultMap id="W8001ProgCtrlPltzItemDomain_SearchForPagingTtPltzItemByCigma" class="W8001ProgCtrlPltzItemDomain">
        <result property="itemDescription" column="ITEM_DESCRIPTION" />
        <result property="pltzItemOdrList" resultMap="W8001ProgCtrl.W8001ProgCtrlPltzItemOdrDomain_SearchForPagingTtPltzItemByCigma" />
    </resultMap>
    <resultMap id="W8001ProgCtrlPltzItemOdrDomain_SearchForPagingTtPltzItemByCigma" class="W8001ProgCtrlPltzItemOdrDomain">
        <result property="itemNo" column="ITEM_NO" />
        <result property="pkgCd" column="PKG_CD" />
        <result property="etdDueDt" column="ETD_DUE_DT" />
        <result property="customerPoNo" column="CUSTOMER_PO_NO" />
        <result property="sumAllocQty" column="SUM_ALLOC_QTY" />
    </resultMap>

    <!-- W8001ProgCtrlDomain_SearchForPagingTtPltzItemByMisc -->
    <resultMap id="W8001ProgCtrlDomain_SearchForPagingTtPltzItemByMisc" class="W8001ProgCtrlDomain">
        <result property="auth" column="AUTH" />
        <result property="pltzItemList" resultMap="W8001ProgCtrl.W8001ProgCtrlPltzItemDomain_SearchForPagingTtPltzItemByMisc" />
    </resultMap>
    <resultMap id="W8001ProgCtrlPltzItemDomain_SearchForPagingTtPltzItemByMisc" class="W8001ProgCtrlPltzItemDomain">
        <result property="itemDescription" column="ITEM_DESCRIPTION" />
        <result property="pltzItemNo" column="PLTZ_ITEM_NO" />
        <result property="pkgCd" column="PKG_CD" />
        <result property="sumQty" column="SUM_QTY" />
        <result property="customerPoNo" column="CUSTOMER_PO_NO" />
    </resultMap>

    <!-- W8001ProgCtrlDomain_SearchForPagingTtPltzItem -->
    <resultMap id="W8001ProgCtrlDomain_SearchForPagingTtPltzItem" class="W8001ProgCtrlPltzItemDomain">
        <result property="pltzItemNo" column="PLTZ_ITEM_NO" />
        <result property="itemDescription" column="ITEM_DESCRIPTION" />
        <result property="modelCd" column="MODEL_CD" />
        <result property="sumQty" column="SUM_QTY" />
    </resultMap>

    <!-- ================================================== -->
    <!-- Main screen / search                               -->
    <!-- ================================================== -->
    <sql id="Search_TtPltzItem_RtTyp">
        select MAIN_MARK, QTY, PKG_CD, PLNT_CD, PLTZ_ITEM_NO, PKG_TYP, RT_FLG
        from TT_PLTZ_ITEM
        <dynamic prepend="where">
            <isNotEmpty property="pltzItemNo" prepend="and" open="(" close=")">
                (PKG_TYP in ('1', '2', '3', '4') and RT_FLG = 'Y')
                or PKG_TYP not in ('1', '2', '3', '4')
                or PKG_TYP is null
            </isNotEmpty>
        </dynamic>
    </sql>
    
    <!-- Cols for selected Item No -->
    <sql id="Cols_SearchForPagingTtPltzByItemNo">
        A.MAIN_MARK
        , A.SHIPPER_CD
        , A.INVOICE_NO
        , A.CONTAINER_LOOSE_TYP
        , A.TRNS_CD
        , A.SHIP_TO_CD
        , A.CONSIGNEE_CD
        , A.CUR_WH_COMP_CD
        , A.INVOICE_CTGRY
        , A.CUR_WH_CD
        , A.CML_TYP
        , A.INVOICE_KEY
        , A.CUSTOM_TIMING_TYP
        , A.LAST_TR_STATUS
        , nvl(sum(B.QTY), 0) sum_qty
        , C.ETD
        , D.ATD
        , D.ETA
        , D.REGISTER_DT
        , E.STG_ACT_DT
        , F.SHIPPING_FIRM_DT
        , G.STG_INSTR_DT
        , J.TIMEZONE_ID
    </sql>
    
    <!-- Cols for selected P/O No -->
    <sql id="Cols_SearchForPagingTtPltzByPoNo">
        A.MAIN_MARK
        , A.SHIPPER_CD
        , A.INVOICE_NO
        , A.CONTAINER_LOOSE_TYP
        , A.TRNS_CD
        , A.SHIP_TO_CD
        , A.CONSIGNEE_CD
        , A.CUR_WH_COMP_CD
        , A.INVOICE_CTGRY
        , A.CUR_WH_CD
        , A.CML_TYP
        , A.INVOICE_KEY
        , A.CUSTOM_TIMING_TYP
        , A.LAST_TR_STATUS
        , C.ETD
        , D.ATD
        , D.ETA
        , D.REGISTER_DT
        , E.STG_ACT_DT
        , F.SHIPPING_FIRM_DT
        , G.STG_INSTR_DT
        , J.TIMEZONE_ID
    </sql>
    
    <!-- From Table / for Search Item No -->
    <sql id="Tables_SearchForPagingTtPltzByItemNo">
        TT_PLTZ A 
        , (<include refid="Search_TtPltzItem_RtTyp"/>) B
        , TT_INVOICE C
        , TT_SHIPPING_ACT D
        , TT_STG_ACT E
        , TT_SHIPPING_FIRM F
        , TT_STG_INSTR G
        , TT_EXP_REQUEST H
        , TM_NXS_COMP J
    </sql>
    
    <!-- From Table / for Search Customer P/O No -->
    <sql id="Tables_SearchForPagingTtPltzByPoNo">
        TT_PLTZ A 
        , (<include refid="Search_TtPltzItem_RtTyp"/>) B
        , TT_INVOICE C
        , TT_SHIPPING_ACT D
        , TT_STG_ACT E
        , TT_SHIPPING_FIRM F
        , TT_STG_INSTR G
        , TT_EXP_REQUEST H
        , TT_PLTZ_ITEM_ODR I
        , TM_NXS_COMP J
    </sql>
    
    <sql id="SortKey_SearchForPagingTtPltz">
        order by
            A.SHIPPER_CD desc
            , A.CONSIGNEE_CD desc
            , A.SHIP_TO_CD desc
            , A.TRNS_CD desc
            , A.MAIN_MARK desc
    </sql>
    
    <!-- 山作・出荷確認・船積実績の絞込 -->
    <sql id="WhereCondition_SearchForPagingTtPltz_Status">
        <isEqual prepend="and" property="status" compareValue="10">
            E.STG_ACT_DT is null 
        and F.SHIPPING_FIRM_DT is null
        and D.REGISTER_DT is null
        </isEqual>
        <isEqual prepend="and" property="status" compareValue="20">
            ((A.CONTAINER_LOOSE_TYP = 'C'
            and E.STG_ACT_DT is not null
            and F.SHIPPING_FIRM_DT is null)
            or (A.CONTAINER_LOOSE_TYP = 'L'
                and A.INVOICE_NO is not null
                and F.SHIPPING_FIRM_DT is null))
        </isEqual>
        <isEqual prepend="and" property="status" compareValue="30">
            F.SHIPPING_FIRM_DT is not null
            and D.REGISTER_DT is null
        </isEqual>
        <isEqual prepend="and" property="status" compareValue="40">
            D.REGISTER_DT is not null 
        </isEqual>
    </sql>
    
    <!-- 絞込条件 / 共通 -->
    <!-- NL040 MOD -->
    <sql id="WhereCondition_SearchForPagingTtPltz">
            A.MAIN_MARK = B.MAIN_MARK(+)
        and A.SHIPPER_CD = C.SHIPPER_CD(+)
        and A.INVOICE_NO = C.INVOICE_NO(+)
        and A.INVOICE_ISSUE_DT = C.INVOICE_ISSUE_DT(+)
        and C.SHIPPING_ACT_NO = D.SHIPPING_ACT_NO(+)
        and A.STG_ACT_NO = E.STG_ACT_NO(+)
        and A.shipping_firm_no = F.SHIPPING_FIRM_NO(+)
        and A.STG_INSTR_NO = G.STG_INSTR_NO(+)
        and A.EXP_REQUEST_NO = H.EXP_REQUEST_NO(+)
        and A.SHIPPER_CD = J.COMP_CD(+)
        <isNotEmpty prepend="and" property="shipperCd">
            A.SHIPPER_CD = #shipperCd#
        </isNotEmpty> 
        <isNotEmpty prepend="and" property="consigneeCd">
            A.CONSIGNEE_CD = #consigneeCd#
        </isNotEmpty>
        <isNotEmpty prepend="and" property="shipToCd">
            A.SHIP_TO_CD = #shipToCd#
        </isNotEmpty>
        <isNotEmpty prepend="and" property="customerCd">
            A.CUSTOMER_CD like concat(#customerCd#, '%')
        </isNotEmpty>
        <isNotEmpty prepend="and" property="lgcyShipTo"> 
            A.LGCY_SHIP_TO = #lgcyShipTo#
        </isNotEmpty>
        <isNotEmpty prepend="and" property="trnsCd">
            A.TRNS_CD = #trnsCd#
        </isNotEmpty>
        <isNotEmpty prepend="and" property="fmExpPackingDt">
            trunc(A.EXP_PACKING_DT) <![CDATA[>=]]> #fmExpPackingDt#
        </isNotEmpty>
        <isNotEmpty prepend="and" property="toExpPackingDt">
            trunc(A.EXP_PACKING_DT) <![CDATA[<=]]> #toExpPackingDt#
        </isNotEmpty>
        <isEqual prepend="and" property="expPackingIssuerId" compareValue="1">
            A.EXP_PACKING_ISSUER_ID = #dscId#
        </isEqual>
        <include refid="WhereCondition_SearchForPagingTtPltz_Status"/>
        <isNotEmpty prepend="and" property="mainMark">
            A.MAIN_MARK like concat(#mainMark#,'%') 
        </isNotEmpty>
        <isNotEmpty prepend="and" property="cmlTyp">
            A.CML_TYP = #cmlTyp#  
        </isNotEmpty>
        <isNotEmpty prepend="and" property="customTimingTyp">
            A.CUSTOM_TIMING_TYP = #customTimingTyp# 
        </isNotEmpty>
        <isNotEmpty prepend="and" property="curWhCompCd"> 
            A.CUR_WH_COMP_CD = #curWhCompCd# 
        </isNotEmpty>
        <isNotEmpty prepend="and" property="curWhCd"> 
            A.CUR_WH_CD = #curWhCd# 
        </isNotEmpty>
        <isNotEmpty prepend="and" property="pkgCd"> 
            B.PKG_CD like concat(#pkgCd#,'%') 
        </isNotEmpty>
        <isEqual prepend="and" property="requestIssuerId" compareValue="1">
            H.REQUEST_ISSUER_ID = #dscId#
        </isEqual>
        <isNotEmpty prepend="and" property="expRequestNo"> 
            H.EXP_REQUEST_NO like concat(#expRequestNo#, '%') 
        </isNotEmpty>
        <isNotEmpty prepend="and" property="returnStyleCd"> 
            upper(A.RETURN_STYLE_CD) = upper(#returnStyleCd#) 
        </isNotEmpty>
        <isNotEmpty prepend="and" property="containerNo"> 
            F.CONTAINER_NO like concat(#containerNo#, '%') 
        </isNotEmpty>
        <isNotEmpty prepend="and" property="invoiceNo"> 
            A.INVOICE_NO like concat(#invoiceNo#, '%')  
        </isNotEmpty>
        <isNotEmpty prepend="and" property="invoiceCtgry">
            A.INVOICE_CTGRY = #invoiceCtgry# 
        </isNotEmpty>
        <isNotEmpty prepend="and" property="fmEtd"> 
            trunc(C.ETD) <![CDATA[>=]]> #fmEtd# 
        </isNotEmpty>
        <isNotEmpty prepend="and" property="toEtd">
            trunc(C.ETD) <![CDATA[<=]]> #toEtd# 
        </isNotEmpty>
        <isParameterPresent prepend="and">
            C.DELETE_FLG(+) = 'N'
        </isParameterPresent>
        <isNotEmpty prepend="and" property="fmAtd">
            trunc(D.ATD) <![CDATA[>=]]> #fmAtd# 
        </isNotEmpty>
        <isNotEmpty prepend="and" property="toAtd">
            trunc(D.ATD) <![CDATA[<=]]> #toAtd#  
        </isNotEmpty>
        <isParameterPresent prepend="and">
            D.DELETE_FLG(+) = 'N'
        </isParameterPresent>
    </sql>
    
    <sql id="WhereCondition_SearchForPagingTtPltzByItemNo_mainMark">
        select MAIN_MARK 
        from TT_PLTZ_ITEM 
        where PLTZ_ITEM_NO = #pltzItemNo#
        and ((PKG_TYP in ('1', '2', '3', '4') and RT_FLG = 'Y') 
            or PKG_TYP not in ('1', '2', '3', '4') 
            or PKG_TYP is null)
    </sql>
    
    <!-- 絞込条件 / Selected ItemNo -->
    <sql id="WhereCondition_SearchForPagingTtPltzByItemNo">
        <isEmpty property="pltzItemNo">
            <include refid="WhereCondition_SearchForPagingTtPltz_Auth" />
        </isEmpty>
        <isNotEmpty property="pltzItemNo" prepend="and">
            B.PLTZ_ITEM_NO = #pltzItemNo#
            
            and (B.PLNT_CD is null
            <isParameterPresent prepend="and" open="(" close=")">
            exists (
                    select
                        'x'
                    from
                        TT_PLTZ T1
                        , TT_PLTZ_ITEM T2
                    where
                        T1.MAIN_MARK = T2.MAIN_MARK
                    and T2.MAIN_MARK in (<include refid="WhereCondition_SearchForPagingTtPltzByItemNo_mainMark"/>)
                    and T1.SHIPPER_CD in (select COMP_CD from TM_NXS_COMP where SERVER_ID = #serverId#)
                    <isNotEmpty prepend="and" property="userAuthList" open=" (T1.SHIPPER_CD, T2.PLNT_CD) in (" close=")">
                        <iterate property="userAuthList" conjunction=",">
                            (#userAuthList[].authMgtComp#, #userAuthList[].procMfgDivCd#)
                        </iterate>
                    </isNotEmpty>
                )
            </isParameterPresent>
            <isParameterPresent prepend="or" open="(" close=")">
                B.PLNT_CD is not null 
                and B.PLTZ_ITEM_NO = #pltzItemNo#
                and ((PKG_TYP in ('1', '2', '3', '4') and RT_FLG = 'Y') 
                    or PKG_TYP not in ('1', '2', '3', '4') 
                    or PKG_TYP is null)
                and A.SHIPPER_CD in (select COMP_CD from TM_NXS_COMP where SERVER_ID = #serverId#)
                <isNotEmpty prepend="and" property="userAuthList" open=" (A.SHIPPER_CD, B.PLNT_CD) in (" close=")">
                    <iterate property="userAuthList" conjunction=",">
                        (#userAuthList[].authMgtComp#, #userAuthList[].procMfgDivCd#)
                    </iterate>
                </isNotEmpty>
            </isParameterPresent>
            )
        </isNotEmpty>
    </sql>
    
    <!-- 絞込条件 / Selected PoNo -->
    <!-- NL040 MOD -->
    <sql id="WhereCondition_SearchForPagingTtPltzByPoNo">
        <isParameterPresent prepend="and">
            B.MAIN_MARK = I.MAIN_MARK(+)
        </isParameterPresent>
        <isNotEmpty prepend="and" property="customerPoNo"> 
            upper(I.CUSTOMER_PO_NO) like concat(upper(#customerPoNo#), '%')
        </isNotEmpty>
    </sql>
    
    <sql id="WhereCondition_SearchForPagingTtPltz_Auth">
        and A.SHIPPER_CD in (select COMP_CD from TM_NXS_COMP where SERVER_ID = #serverId#)
        <isNotEmpty prepend="and" property="userAuthList" open=" (A.SHIPPER_CD, B.PLNT_CD) in (" close=")">
            <iterate property="userAuthList" conjunction=",">
                (#userAuthList[].authMgtComp#, #userAuthList[].procMfgDivCd#)
            </iterate>
        </isNotEmpty>
    </sql>
    
    <sql id="GroupBy_SearchForPagingTtPltz">
        group by 
            A.MAIN_MARK
            , A.SHIPPER_CD
            , A.INVOICE_NO
            , A.CONTAINER_LOOSE_TYP
            , A.TRNS_CD
            , A.SHIP_TO_CD
            , A.CONSIGNEE_CD
            , A.CUR_WH_COMP_CD
            , A.INVOICE_CTGRY
            , A.CUR_WH_CD
            , A.CML_TYP
            , A.INVOICE_KEY
            , A.CUSTOM_TIMING_TYP
            , A.LAST_TR_STATUS
            , C.ETD
            , D.SHIPPING_ACT_NO
            , D.ATD
            , D.ETA
            , D.REGISTER_DT
            , E.STG_ACT_DT
            , F.SHIPPING_FIRM_DT
            , G.STG_INSTR_DT
            , J.TIMEZONE_ID
    </sql>
    
    <!-- Sql/ search count for Selected Item No -->
    <select id="SearchCountTtPltzByItemNo"
        resultClass="java.lang.Integer" parameterClass="W8001ProgCtrlCriteriaDomain">
        select /* SqlMap-W8001ProgCtrl.SearchCountTtPltzByItemNo */
            count(MAIN_MARK) COUNT_MAIN_MARK
        from
            (select
                <include refid="Cols_SearchForPagingTtPltzByItemNo"/>
                ,row_number() over (<include refid="SortKey_SearchForPagingTtPltz"/>) ROW_NUM 
             from <include refid="Tables_SearchForPagingTtPltzByItemNo"/>
             where 
                <include refid="WhereCondition_SearchForPagingTtPltz"/>
                <!--<include refid="WhereCondition_SearchForPagingTtPltz_Auth" />-->
                <include refid="WhereCondition_SearchForPagingTtPltzByItemNo" />
                <include refid="GroupBy_SearchForPagingTtPltz"/>
             )
    </select>
    
    <!-- Sql/ search for paging for selected Item No -->
    <select id="SearchForPagingTtPltzByItemNo"
        resultMap="W8001ProgCtrlDomain_SearchForPagingTtPltzByItemNo" parameterClass="W8001ProgCtrlCriteriaDomain">
        select 
            /* SqlMap-W8001ProgCtrl.SearchForPagingTtPltzByItemNo */
            MAIN_MARK
            , SHIPPER_CD
            , INVOICE_NO
            , CONTAINER_LOOSE_TYP
            , TRNS_CD
            , SHIP_TO_CD
            , CONSIGNEE_CD
            , CUR_WH_COMP_CD
            , INVOICE_CTGRY
            , CUR_WH_CD
            , CML_TYP
            , INVOICE_KEY
            , CUSTOM_TIMING_TYP
            , LAST_TR_STATUS
            , ETD
            , ATD
            , ETA
            , REGISTER_DT
            , STG_ACT_DT
            , SHIPPING_FIRM_DT
            , STG_INSTR_DT
            , SUM_QTY
            , TIMEZONE_ID
        from
            (select
                <include refid="Cols_SearchForPagingTtPltzByItemNo"/>
                ,row_number() over (<include refid="SortKey_SearchForPagingTtPltz"/>) ROW_NUM 
             from <include refid="Tables_SearchForPagingTtPltzByItemNo"/>
             where 
                <include refid="WhereCondition_SearchForPagingTtPltz"/>
                <!--<include refid="WhereCondition_SearchForPagingTtPltz_Auth" />-->
                <include refid="WhereCondition_SearchForPagingTtPltzByItemNo" />
                <include refid="GroupBy_SearchForPagingTtPltz"/>
                <include refid="SortKey_SearchForPagingTtPltz"/>
            ) 
    </select>

    <!-- Sql / Search count for selected P/O No -->
    <select id="SearchCountTtPltzByPoNo"
        resultClass="java.lang.Integer" parameterClass="W8001ProgCtrlCriteriaDomain">
        select /* SqlMap-W8001ProgCtrl.SearchCountTtPltzByPoNo */
            count(MAIN_MARK) COUNT_MAIN_MARK
        from
            (select
                <include refid="Cols_SearchForPagingTtPltzByPoNo"/>
                ,row_number() over (<include refid="SortKey_SearchForPagingTtPltz"/>) ROW_NUM 
             from <include refid="Tables_SearchForPagingTtPltzByPoNo"/>
             where 
                <include refid="WhereCondition_SearchForPagingTtPltz"/>
                <include refid="WhereCondition_SearchForPagingTtPltzByPoNo"/>
                <include refid="WhereCondition_SearchForPagingTtPltz_Auth" />
                <include refid="GroupBy_SearchForPagingTtPltz"/>
             )
    </select>
    
    <!-- Sql / Search for selected P/O No -->
    <select id="SearchForPagingTtPltzByPoNo"
        resultMap="W8001ProgCtrlDomain_SearchForPagingTtPltzByPoNo" parameterClass="W8001ProgCtrlCriteriaDomain">
        select 
            /* SqlMap-W8001ProgCtrl.SearchForPagingTtPltzByPoNo */
            MAIN_MARK
            , SHIPPER_CD
            , INVOICE_NO
            , TRNS_CD
            , SHIP_TO_CD
            , CONSIGNEE_CD
            , CUR_WH_COMP_CD
            , INVOICE_CTGRY
            , CUR_WH_CD
            , CML_TYP
            , INVOICE_KEY
            , CUSTOM_TIMING_TYP
            , LAST_TR_STATUS
            , ETD
            , ATD
            , ETA
            , REGISTER_DT
            , STG_ACT_DT
            , SHIPPING_FIRM_DT
            , STG_INSTR_DT
            , TIMEZONE_ID
        from
            (select
                <include refid="Cols_SearchForPagingTtPltzByPoNo"/>
                ,row_number() over (<include refid="SortKey_SearchForPagingTtPltz"/>) ROW_NUM 
             from <include refid="Tables_SearchForPagingTtPltzByPoNo"/>
             where 
                <include refid="WhereCondition_SearchForPagingTtPltz"/>
                <include refid="WhereCondition_SearchForPagingTtPltzByPoNo"/>
                <include refid="WhereCondition_SearchForPagingTtPltz_Auth" />
                <include refid="GroupBy_SearchForPagingTtPltz"/>
                <include refid="SortKey_SearchForPagingTtPltz"/>
            ) 
    </select>

    <!-- ================================================== -->
    <!-- 実行SQL                                            -->
    <!-- ================================================== -->
    <select id="SearchTtPltz"
        resultMap="W8001ProgCtrlDomain_SearchTtPltz" parameterClass="W8001ProgCtrlCriteriaDomain">
        select /* SqlMap-W8001ProgCtrl.SearchTtPltz */
             T1.TRNS_CD
            ,T1.CML_TYP
            ,T1.CONSIGNEE_CD
            ,T1.SHIP_TO_CD
            ,T1.CUSTOMER_CD
            ,T1.LGCY_SHIP_TO
            ,T1.STG_INSTR_ITEM_FLG
            ,T1.VOLUME
            ,T1.NET_WEIGHT
            ,T1.GROSS_WEIGHT
            ,T1.CONTAINER_SORTING_KEY
            ,T1.LOADING_CD
            ,T1.CONTAINER_LOOSE_TYP
            ,T1.RETURN_STYLE_CD
            ,T1.STG_INSTR_NO
            ,T1.XMAIN_MARK
            ,T1.STG_ACT_NO
            ,T1.SHIPPING_FIRM_NO
            ,T1.SHIPPER_CD
            ,T1.INVOICE_NO
            ,T1.EXP_REQUEST_NO
            ,T1.INVOICE_CTGRY
            ,T2.PRICE_TERMS
            ,T2.TRADE_TERMS
            ,T2.CURR_CD
            ,T2.LC_NO
            ,T2.FREIGHT
            ,T2.FREIGHT_RESPONSIBLE_CD
            ,T2.INSURANCE
            ,T2.NET_AMOUNT
            ,T2.TOTAL_INVOICE_AMOUNT
            ,T2.LOADING_PORT_CD
            ,T2.DISCHARGE_PORT_CD
            ,T2.PAY_METH
            ,T2.PAY_TERMS
            ,T7.VOLUME TOTAL_VOLUME
            ,T7.NET_WEIGHT TOTAL_NET_WEIGHT
            ,T7.GROSS_WEIGHT TOTAL_GROSS_WEIGHT
            ,T7.WEIGHT_UNIT TOTAL_WEIGHT_UNIT
            ,T7.VOLUME_UNIT TOTAL_VOLUME_UNIT
            ,T9.BILLD_NO
            ,T9.ATD
            ,T9.ETA
            ,T9.CARRIER_COMP_CD
            ,T9.VESSEL
            ,T3_1.COMP_NM_ABB      COMP_NM_ABB1
            ,T4_1.SHIP_TO_NM_ABB   SHIP_TO_NM_ABB1
            ,T3_2.COMP_NM_ABB      COMP_NM_ABB2
            ,T4_2.SHIP_TO_NM_ABB   SHIP_TO_NM_ABB2
            ,T6_1.UNIT_DISP    WEIGHT_UNIT_DISP
            ,T6_2.UNIT_DISP    VOLUME_UNIT_DISP
            ,T8.CONTAINER_NO 
        from
             TT_PLTZ T1
            ,TT_INVOICE T2
            ,TM_NXS_COMP T3_1
            ,TM_NXS_COMP T3_2
            ,TM_NXS_SHIP_TO T4_1
            ,TM_NXS_SHIP_TO T4_2
            ,TM_CIGMA_SHIP_TO_XREF T5
            ,TM_MEASURE_UNIT T6_1
            ,TM_MEASURE_UNIT T6_2
            ,TT_XPLTZ T7
            ,TT_SHIPPING_FIRM T8
            ,TT_SHIPPING_ACT T9 
        where
            T1.INVOICE_NO = T2.INVOICE_NO(+) 
        and T1.SHIPPER_CD = T2.SHIPPER_CD(+) 
        and T1.INVOICE_ISSUE_DT = T2.INVOICE_ISSUE_DT(+) 
        and T1.CONSIGNEE_CD = T3_1.COMP_CD(+) 
        and T1.SHIP_TO_CD = T4_1.SHIP_TO_CD(+) 
        and T1.SHIPPER_CD = T5.LGCY_LIB_COMP_CD(+) 
        and T1.CUSTOMER_CD = T5.CUSTOMER_CD(+) 
        and T1.LGCY_SHIP_TO = T5.LGCY_SHIP_TO(+) 
        and T5.SHIP_TO_CD = T4_2.SHIP_TO_CD(+) 
        and T1.SHIPPER_CD = T3_2.COMP_CD(+) 
        and T1.WEIGHT_UNIT = T6_1.UNIT_CD(+) 
        and T1.VOLUME_UNIT = T6_2.UNIT_CD(+) 
        and T1.XMAIN_MARK = T7.XMAIN_MARK(+) 
        and T1.SHIPPING_FIRM_NO = T8.SHIPPING_FIRM_NO(+) 
        and T2.SHIPPING_ACT_NO = T9.SHIPPING_ACT_NO(+) 
        and T1.MAIN_MARK = #mainMark#
    </select>

    <!-- ================================================== -->
    <!-- 実行SQL                                            -->
    <!-- ================================================== -->
    <select id="SearchCountTtPltzItemByCigma"
        resultClass="java.lang.Integer" parameterClass="W8001ProgCtrlCriteriaDomain">
        select /* SqlMap-W8001ProgCtrl.SearchCountTtPltzItemByCigma */
             count(*) COUNT_MAIN_MARK
        from
            ( 
                select
                     T1.ITEM_DESCRIPTION
                    ,T2.ITEM_NO
                    ,T2.PKG_CD
                    ,T2.ETD_DUE_DT
                    ,T2.CUSTOMER_PO_NO
                    ,sum(T2.ALLOC_QTY) SUM_ALLOC_QTY
                    ,T1.MAIN_MARK
                    ,T1.PLNT_CD 
                from
                    ( 
                        select
                             MAIN_MARK
                            ,BRCH
                            ,ITEM_DESCRIPTION
                            ,PLNT_CD 
                        from
                            TT_PLTZ_ITEM 
                        where
                            MAIN_MARK = #mainMark# 
                        and PKG_TYP is null
                    ) T1
                    ,TT_PLTZ_ITEM_ODR T2 
                where
                    T1.MAIN_MARK = T2.MAIN_MARK 
                and T1.BRCH = T2.BRCH 
                group by
                     T1.ITEM_DESCRIPTION
                    ,T2.ITEM_NO
                    ,T2.PKG_CD
                    ,T2.ETD_DUE_DT
                    ,T2.CUSTOMER_PO_NO
                    ,T1.MAIN_MARK
                    ,T1.PLNT_CD 
            ) 
    </select>
    <!-- ================================================== -->
    <!-- 実行SQL                                            -->
    <!-- ================================================== -->
    <select id="SearchForPagingTtPltzItemByCigma"
        resultMap="W8001ProgCtrlDomain_SearchForPagingTtPltzItemByCigma" parameterClass="W8001ProgCtrlCriteriaDomain">
        select /* SqlMap-W8001ProgCtrl.SearchForPagingTtPltzItemByCigma */
             T1.ITEM_DESCRIPTION ITEM_DESCRIPTION
            ,T2.ITEM_NO          ITEM_NO
            ,T2.PKG_CD           PKG_CD
            ,T2.ETD_DUE_DT       ETD_DUE_DT
            ,T2.CUSTOMER_PO_NO   CUSTOMER_PO_NO
            ,sum(T2.ALLOC_QTY)   SUM_ALLOC_QTY
            ,( 
               select
                   min(
                        <isNotEmpty  property="userAuthList">
                        case
                          <iterate property = "userAuthList" > 
                               when A1.SHIPPER_CD = #userAuthList[].authMgtComp# and T1.PLNT_CD = #userAuthList[].procMfgDivCd# 
                                   then #userAuthList[].authority# 
                          </iterate > 
                           else '0' 
                           end
                        </isNotEmpty>
                        <isEmpty  property="userAuthList">
                            '0'
                        </isEmpty>
                   ) 
               from
                   TT_PLTZ A1 
               where
                   A1.MAIN_MARK = T1.MAIN_MARK
            ) AUTH
        from
            ( 
                select
                     MAIN_MARK
                    ,BRCH
                    ,ITEM_DESCRIPTION
                    ,PLNT_CD 
                from
                    TT_PLTZ_ITEM 
                where
                    MAIN_MARK = #mainMark# 
                and PKG_TYP is null
            ) T1
            , TT_PLTZ_ITEM_ODR T2 
        where
            T1.MAIN_MARK = T2.MAIN_MARK 
        and T1.BRCH = T2.BRCH 
        group by
             T1.ITEM_DESCRIPTION
            ,T2.ITEM_NO
            ,T2.PKG_CD
            ,T2.ETD_DUE_DT
            ,T2.CUSTOMER_PO_NO
            ,T1.PLNT_CD
            ,T1.MAIN_MARK 
        order by
             T2.CUSTOMER_PO_NO
            ,T2.ETD_DUE_DT
            ,T1.ITEM_DESCRIPTION
            ,T2.ITEM_NO
            ,T2.PKG_CD
    </select>
    
    <!-- ================================================== -->
    <!-- 実行SQL                                            -->
    <!-- ================================================== -->
    <select id="SearchForPagingTtPltzItemByCigmaSort"
        resultMap="W8001ProgCtrlDomain_SearchForPagingTtPltzItemByCigma" parameterClass="W8001ProgCtrlCriteriaDomain">
        select /* SqlMap-W8001ProgCtrl.SearchForPagingTtPltzItemByCigmaSort */
             T1.ITEM_DESCRIPTION ITEM_DESCRIPTION
            ,T2.ITEM_NO          ITEM_NO
            ,T2.PKG_CD           PKG_CD
            ,T2.ETD_DUE_DT       ETD_DUE_DT
            ,T2.CUSTOMER_PO_NO   CUSTOMER_PO_NO
            ,sum(T2.ALLOC_QTY)   SUM_ALLOC_QTY 
            ,( 
               select
                   min(
                        <isNotEmpty  property="userAuthList">
                        case
                          <iterate property = "userAuthList" > 
                               when A1.SHIPPER_CD = #userAuthList[].authMgtComp# and T1.PLNT_CD = #userAuthList[].procMfgDivCd# 
                                   then #userAuthList[].authority# 
                          </iterate > 
                           else '0' 
                           end
                        </isNotEmpty>
                        <isEmpty  property="userAuthList">
                            '0'
                        </isEmpty>
                   ) 
               from
                   TT_PLTZ A1
               where
                   A1.MAIN_MARK = T1.MAIN_MARK 
            ) AUTH 
        from
            ( 
                select
                    MAIN_MARK
                    , BRCH
                    , ITEM_DESCRIPTION
                    , PLNT_CD 
                from
                    TT_PLTZ_ITEM 
                where
                    MAIN_MARK = #mainMark#
                    and PKG_TYP is null
            ) T1
            ,TT_PLTZ_ITEM_ODR T2 
        where
            T1.MAIN_MARK = T2.MAIN_MARK 
        and T1.BRCH = T2.BRCH 
        group by
             T1.ITEM_DESCRIPTION
            ,T2.ITEM_NO
            ,T2.PKG_CD
            ,T2.ETD_DUE_DT
            ,T2.CUSTOMER_PO_NO
            ,T1.PLNT_CD
            ,T1.MAIN_MARK 
        <!-- Order By -->
            <!-- 【2】:Item No.（コンボ）が"10"（ASC）の場合 -->
            <isEqual prepend="order by" property="selectSort" compareValue="1">
                 T2.ITEM_NO
                ,T2.PKG_CD
                ,T2.CUSTOMER_PO_NO
                ,T2.ETD_DUE_DT
                ,T1.ITEM_DESCRIPTION
            </isEqual>
            <!-- 【2】:Item No.（コンボ）が"20"（DESC）の場合 -->
            <isEqual prepend="order by" property="selectSort" compareValue="2">
                 T2.ITEM_NO desc
                ,T2.PKG_CD
                ,T2.CUSTOMER_PO_NO
                ,T2.ETD_DUE_DT
                ,T1.ITEM_DESCRIPTION
            </isEqual>
            <!-- 【2】:Item No.（コンボ）が"30"（UNDO）の場合 -->
            <isEqual prepend="order by" property="selectSort" compareValue="3">
                 T2.CUSTOMER_PO_NO
                ,T2.ETD_DUE_DT
                ,T1.ITEM_DESCRIPTION
                ,T2.ITEM_NO
                ,T2.PKG_CD
            </isEqual>
    </select>
    
    <!-- ================================================== -->
    <!-- 実行SQL                                            -->
    <!-- ================================================== -->
    <select id="SearchCountTtPltzItemByMisc"
        resultClass="java.lang.Integer" parameterClass="W8001ProgCtrlCriteriaDomain">
        select /* SqlMap-W8001ProgCtrl.SearchCountTtPltzItemByMisc */
             count(*) COUNT_MAIN_MARK
        from
            ( 
                select
                     T1.ITEM_DESCRIPTION
                    ,T1.PLTZ_ITEM_NO
                    ,T1.PKG_CD
                    ,sum(T1.QTY) SUM_QTY
                    ,T2.CUSTOMER_PO_NO
                    ,T1.PLNT_CD
                    ,T1.MAIN_MARK 
                from
                    ( 
                        select
                             EXP_REQUEST_NO
                            ,LINE_NO
                            ,ITEM_DESCRIPTION
                            ,PLTZ_ITEM_NO
                            ,PKG_CD
                            ,QTY
                            ,MAIN_MARK
                            ,PLNT_CD 
                        from
                            TT_PLTZ_ITEM 
                        where
                            MAIN_MARK = #mainMark#
                        and PKG_TYP is null 
                        and (KIT_FLG = 'N' or PAR_FLG = 'N')
                    ) T1
                    , ( 
                        select
                             EXP_REQUEST_NO
                            ,LINE_NO
                            ,CUSTOMER_PO_NO 
                        from
                            TT_EXP_REQUEST_DTL
                    ) T2 
                where
                    T1.EXP_REQUEST_NO = T2.EXP_REQUEST_NO 
                and T1.LINE_NO = T2.LINE_NO 
                group by
                     T1.ITEM_DESCRIPTION
                    ,T1.PLTZ_ITEM_NO
                    ,T1.PKG_CD
                    ,T2.CUSTOMER_PO_NO
                    ,T1.PLNT_CD
                    ,T1.MAIN_MARK 
            )

    </select>
    <!-- ================================================== -->
    <!-- 実行SQL                                            -->
    <!-- ================================================== -->
    <select id="SearchForPagingTtPltzItemByMisc"
        resultMap="W8001ProgCtrlDomain_SearchForPagingTtPltzItemByMisc" parameterClass="W8001ProgCtrlCriteriaDomain">
        select /* SqlMap-W8001ProgCtrl.SearchForPagingTtPltzItemByMisc */
             T1.ITEM_DESCRIPTION ITEM_DESCRIPTION
            ,T1.PLTZ_ITEM_NO     PLTZ_ITEM_NO
            ,T1.PKG_CD           PKG_CD
            ,sum(T1.QTY)       SUM_QTY
            ,T2.CUSTOMER_PO_NO   CUSTOMER_PO_NO
            ,( 
               select
                   min(
                        <isNotEmpty  property="userAuthList">
                        case
                          <iterate property = "userAuthList" > 
                               when A1.SHIPPER_CD = #userAuthList[].authMgtComp# and T1.PLNT_CD = #userAuthList[].procMfgDivCd# 
                                   then #userAuthList[].authority# 
                          </iterate > 
                           else '0' 
                           end
                        </isNotEmpty>
                        <isEmpty  property="userAuthList">
                            '0'
                        </isEmpty>
                   ) 
               from
                   TT_PLTZ A1
               where
                   A1.MAIN_MARK = T1.MAIN_MARK
            ) AUTH 
        from
            ( 
                select
                     EXP_REQUEST_NO
                    ,LINE_NO
                    ,ITEM_DESCRIPTION
                    ,PLTZ_ITEM_NO
                    ,PKG_CD
                    ,QTY
                    ,MAIN_MARK
                    ,PLNT_CD 
                from
                    TT_PLTZ_ITEM 
                where
                    MAIN_MARK = #mainMark#
                and PKG_TYP is null 
                and (KIT_FLG = 'N' or PAR_FLG = 'N')
            ) T1
            , ( 
                select
                     EXP_REQUEST_NO
                    ,LINE_NO
                    ,CUSTOMER_PO_NO 
                from
                    TT_EXP_REQUEST_DTL
            ) T2 
        where
            T1.EXP_REQUEST_NO = T2.EXP_REQUEST_NO 
        and T1.LINE_NO = T2.LINE_NO 
        group by
             T1.ITEM_DESCRIPTION
            ,T1.PLTZ_ITEM_NO
            ,T1.PKG_CD
            ,T2.CUSTOMER_PO_NO
            ,T1.PLNT_CD
            ,T1.MAIN_MARK 
        order by
             T2.CUSTOMER_PO_NO
            ,T1.ITEM_DESCRIPTION
            ,T1.PLTZ_ITEM_NO
            ,T1.PKG_CD
    </select>

    <!-- ================================================== -->
    <!-- 実行SQL                                            -->
    <!-- ================================================== -->
    <select id="SearchForPagingTtPltzItemByMiscSort"
        resultMap="W8001ProgCtrlDomain_SearchForPagingTtPltzItemByMisc" parameterClass="W8001ProgCtrlCriteriaDomain">
        select /* SqlMap-W8001ProgCtrl.SearchForPagingTtPltzItemByMiscSort */
             T1.ITEM_DESCRIPTION ITEM_DESCRIPTION
            ,T1.PLTZ_ITEM_NO     PLTZ_ITEM_NO
            ,T1.PKG_CD           PKG_CD
            ,sum(T1.QTY)       SUM_QTY
            ,T2.CUSTOMER_PO_NO   CUSTOMER_PO_NO
           ,( 
              select
                  min(
                    <isNotEmpty  property="userAuthList">
                    case
                      <iterate property = "userAuthList" > 
                           when A1.SHIPPER_CD = #userAuthList[].authMgtComp# and T1.PLNT_CD = #userAuthList[].procMfgDivCd# 
                               then #userAuthList[].authority# 
                      </iterate > 
                       else '0' 
                       end
                    </isNotEmpty>
                    <isEmpty  property="userAuthList">
                        '0'
                    </isEmpty>
                  ) 
              from
                  TT_PLTZ A1
              where
                  A1.MAIN_MARK = T1.MAIN_MARK
           ) AUTH 
        from
            ( 
                select
                     EXP_REQUEST_NO
                    ,LINE_NO
                    ,ITEM_DESCRIPTION
                    ,PLTZ_ITEM_NO
                    ,PKG_CD
                    ,QTY
                    ,MAIN_MARK
                    ,PLNT_CD 
                from
                    TT_PLTZ_ITEM 
                where
                    MAIN_MARK = #mainMark# 
                and PKG_TYP is null 
                and (KIT_FLG = 'N' or PAR_FLG = 'N')
            ) T1
            , ( 
                select
                     EXP_REQUEST_NO
                    ,LINE_NO
                    ,CUSTOMER_PO_NO 
                from
                    TT_EXP_REQUEST_DTL
            ) T2 
        where
            T1.EXP_REQUEST_NO = T2.EXP_REQUEST_NO 
        and T1.LINE_NO = T2.LINE_NO 
        group by
             T1.ITEM_DESCRIPTION
            ,T1.PLTZ_ITEM_NO
            ,T1.PKG_CD
            ,T2.CUSTOMER_PO_NO
            ,T1.PLNT_CD
            ,T1.MAIN_MARK 
        <!-- Order By -->
            <!-- 【2】:Item No.（コンボ）が"10"（ASC）の場合 -->
            <isEqual prepend="order by" property="selectSort" compareValue="1">
                 T1.PLTZ_ITEM_NO
                ,T1.PKG_CD
                ,T2.CUSTOMER_PO_NO
                ,T1.ITEM_DESCRIPTION
            </isEqual>
            <!-- 【2】:Item No.（コンボ）が"20"（DESC）の場合 -->
            <isEqual prepend="order by" property="selectSort" compareValue="2">
                 T1.PLTZ_ITEM_NO desc
                ,T1.PKG_CD
                ,T2.CUSTOMER_PO_NO
                ,T1.ITEM_DESCRIPTION
            </isEqual>
            <!-- 【2】:Item No.（コンボ）が"30"（UNDO）の場合 -->
            <isEqual prepend="order by" property="selectSort" compareValue="3">
                 T2.CUSTOMER_PO_NO
                ,T1.ITEM_DESCRIPTION
                ,T1.PLTZ_ITEM_NO
                ,T1.PKG_CD
            </isEqual>
    </select>

    <!-- ================================================== -->
    <!-- 実行SQL                                            -->
    <!-- ================================================== -->
    <select id="SearchCountTtPltzItem"
        resultClass="java.lang.Integer" parameterClass="W8001ProgCtrlCriteriaDomain">
        select /* SqlMap-W8001ProgCtrl.SearchCountTtPltzItem */
             count(*) 
        from
            (
            select
                'X'
            from
                TT_PLTZ_ITEM 
            where
                MAIN_MARK = #mainMark#
            and RT_FLG = 'Y' 
            group by
                 PLTZ_ITEM_NO
                ,ITEM_DESCRIPTION
                ,MODEL_CD 
            )
    </select>
    <!-- ================================================== -->
    <!-- 実行SQL                                            -->
    <!-- ================================================== -->
    <select id="SearchForPagingTtPltzItem"
        resultMap="W8001ProgCtrlDomain_SearchForPagingTtPltzItem" parameterClass="W8001ProgCtrlCriteriaDomain">
        select /* SqlMap-W8001ProgCtrl.SearchForPagingTtPltzItem */
             PLTZ_ITEM_NO
            ,ITEM_DESCRIPTION
            ,MODEL_CD
            ,sum(QTY) SUM_QTY
        from
            TT_PLTZ_ITEM 
        where
            MAIN_MARK = #mainMark#
        and RT_FLG = 'Y' 
        group by
             PLTZ_ITEM_NO
            ,ITEM_DESCRIPTION
            ,MODEL_CD 
        order by
            PLTZ_ITEM_NO
    </select>

</sqlMap>